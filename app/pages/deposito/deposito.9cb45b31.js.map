{"mappings":"AACO,SAAAA,EAAqBC,EAAOC,EAAKC,EAAMC,GAC5CC,KAAKJ,MAAQA,EACbI,KAAKH,IAAMA,EACXG,KAAKF,KAAOA,EACZE,KAAKD,KAAOA,ECmCdE,GAAE,eAGIC,EAFaC,aAAaC,QArCV,aAuCI,aAAe,qBACvCH,EAAE,SAASI,KAAKH,GAChBD,EAAE,WAAWI,KAAK,gBAElBC,YAAW,WACTL,EAAE,YAAYM,UACdC,SAASC,cAAc,SAASC,iBA9BvBC,MAAOC,gBA+Bf,QC0BLC,OAAOC,OAAS,WACdN,SAASC,cAAc,iBAAiBM,SAAW,SAAUC,GAC3DA,EAAEC,iBAhEN,eACMrB,GAASK,EAAE,kBAAkBiB,SAE7BtB,EAAQ,SACVK,EAAE,kBAAkBkB,SAAS,oBAC7BlB,EAAE,wBACCmB,KAAK,6DACLC,YACAC,MAAM,KACNC,WACI,QAGHC,EAAOC,KAAKC,MAAMvB,aAAaC,QDzBlB,oBC4BfP,EDrBqB,ICqBfD,EACN+B,EAAW/B,EAAQC,EAGnB+B,EAAOC,WAAW1B,aAAaC,QD/BnB,WCgCZ0B,EAAaF,EACbD,EAAWC,GACbA,GAAQD,EACR9B,GAAO8B,EACPA,EAAW,IAEXA,GAAsBC,EACtB/B,GAAO+B,EACPA,EAAO,GAITzB,aAAa4B,QD5CG,SC4CsBH,GAEtCJ,EAAKQ,SAAWL,MACZM,EAAAA,IAAAA,EAA8BN,EAAU9B,ED3ClB,WC2CkBA,IAAuBc,MACnEa,EAAKU,aAAaC,KAAKF,GACvB9B,aAAa4B,QDlDM,cCkDgBN,KAAKW,UAAUZ,IAElDvB,EAAE,wBACCoC,YAAY,OACZlB,SAAS,QACTC,KAAAA,kBACmBO,EAASW,QACzB,0JAGgDR,EAAWQ,QAAQ,OAEtEjB,YACAC,MAAM,KACNC,UAEHtB,EAAE,kBAAkBiB,IAAI,IAWtBqB,IAEFtC,EAAE,UAAUuC,KAAK,SAAA,CACfC,SAAS","sources":["./app/model/transaction.js","./app/util/shared.js","./app/pages/deposito/deposit.js"],"sourcesContent":["'use strict';\r\nexport function Transaction(value, tax, type, date) {\r\n  this.value = value;\r\n  this.tax = tax;\r\n  this.type = type;\r\n  this.date = date;\r\n}\r\n","'use strict';\r\n\r\nconst USERNAME_KEY = 'tomaz.leite';\r\nconst COSTS_KEY = 'custos';\r\nconst LOGGED_IN_KEY = 'eh_logado';\r\n\r\nexport const WITHDRAW_TYPE = 'saque';\r\nexport const DEPOSIT_TYPE = 'deposito';\r\n\r\nexport const TAX_DEPOSIT = 0.01;\r\nexport const TAX_WITHDRAW = 0.02;\r\nexport const TAX_BALANCE = 0.25;\r\nexport const TAX_BANK_STATEMENT = 0.25;\r\n\r\n/**\r\n * Retorna o ano corrente com quatro dígitos.\r\n * @returns\r\n */\r\nfunction currentYear() {\r\n  return new Date().getFullYear();\r\n}\r\n\r\nfunction formatZero(date) {\r\n  return parseInt(date) < 10 ? '0' + date : date;\r\n}\r\n\r\nexport function formatFullDate(d) {\r\n  return (\r\n    formatZero(d.getDate()) +\r\n    '/' +\r\n    formatZero(d.getMonth()) +\r\n    '/' +\r\n    formatZero(d.getFullYear())\r\n  );\r\n}\r\n\r\n/**\r\n * Configurações da tela realizadas no carregamento da aplicação\r\n * de acordo com o estado de login do usuário.\r\n */\r\n$(function () {\r\n  let isLoggedIn = localStorage.getItem(LOGGED_IN_KEY);\r\n\r\n  let menu = isLoggedIn ? '/menu.html' : '/menu-anonimo.html';\r\n  $('#menu').load(menu);\r\n  $('#footer').load('/footer.html');\r\n\r\n  setTimeout(function () {\r\n    $('.sidenav').sidenav();\r\n    document.querySelector('#year').textContent = currentYear();\r\n  }, 1000);\r\n});\r\n\r\nexport { USERNAME_KEY, COSTS_KEY as TOTAL_COSTS_KEY, LOGGED_IN_KEY };\r\n","'use strict';\r\n\r\nimport {\r\n  DEPOSIT_TYPE,\r\n  TAX_DEPOSIT,\r\n  TOTAL_COSTS_KEY,\r\n  USERNAME_KEY,\r\n} from '../../util/shared.js';\r\n\r\nimport { Transaction } from '../../model/transaction.js';\r\n\r\n/**\r\n\tRealiza o depósito\r\n*/\r\nfunction doDeposit() {\r\n  let value = +$('#input-deposit').val();\r\n\r\n  if (value < 5) {\r\n    $('#input-deposit').addClass('my-invalid-input');\r\n    $('#div-deposit-message')\r\n      .html('Opps!!! O valor precisa ser maior que ou igual a 5 Reais.')\r\n      .slideDown()\r\n      .delay(3000)\r\n      .slideUp();\r\n    return false;\r\n  }\r\n\r\n  const user = JSON.parse(localStorage.getItem(USERNAME_KEY));\r\n\r\n  //tarifa de deposito\r\n  let tax = value * TAX_DEPOSIT;\r\n  let netValue = value - tax;\r\n\r\n  //custos para visualização do saldo e extrato\r\n  let cost = parseFloat(localStorage.getItem(TOTAL_COSTS_KEY));\r\n  let costBefore = cost;\r\n  if (netValue < cost) {\r\n    cost -= netValue;\r\n    tax += netValue;\r\n    netValue = 0;\r\n  } else {\r\n    netValue = netValue - cost;\r\n    tax += cost;\r\n    cost = 0;\r\n  }\r\n\r\n  //persiste novamente o custo\r\n  localStorage.setItem(TOTAL_COSTS_KEY, cost);\r\n\r\n  user.balance += netValue;\r\n  let transaction = new Transaction(netValue, tax, DEPOSIT_TYPE, new Date());\r\n  user.transactions.push(transaction);\r\n  localStorage.setItem(USERNAME_KEY, JSON.stringify(user));\r\n\r\n  $('#div-deposit-message')\r\n    .removeClass('red')\r\n    .addClass('blue')\r\n    .html(\r\n      `Depósito de R$ ${netValue.toFixed(\r\n        2\r\n      )} efetuado com sucesso considerando a pequena taxa \r\n    de ${TAX_DEPOSIT * 100}% e os pequenos custos acumulados\r\n    de visualização de saldo e extrato no valor de R$ ${costBefore.toFixed(2)}!`\r\n    )\r\n    .slideDown()\r\n    .delay(3000)\r\n    .slideUp();\r\n\r\n  $('#input-deposit').val('');\r\n\r\n  return false;\r\n}\r\n\r\n/**\r\n * Dispara quando o DOM está pronto e também os recursos dependentes (CSS, Imagens e JS)\r\n */\r\nwindow.onload = function () {\r\n  document.querySelector('#form-deposit').onsubmit = function (e) {\r\n    e.preventDefault();\r\n    doDeposit();\r\n  };\r\n  $('.money').mask('000.00', {\r\n    reverse: true,\r\n  });\r\n};\r\n"],"names":["$9015cb1fd183f081530878d23decbcb7$export$Transaction","value","tax","type","date","this","$","menu","localStorage","getItem","load","setTimeout","sidenav","document","querySelector","textContent","Date","getFullYear","window","onload","onsubmit","e","preventDefault","val","addClass","html","slideDown","delay","slideUp","user","JSON","parse","netValue","cost","parseFloat","costBefore","setItem","balance","transaction","transactions","push","stringify","removeClass","toFixed","$440aa289c05991009dc1f288d3fcb4c3$var$doDeposit","mask","reverse"],"version":3,"file":"deposito.9cb45b31.js.map"}